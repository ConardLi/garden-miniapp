<view class="container">
  <!-- å›¾ç‰‡é€‰æ‹©/é¢„è§ˆåŒºåŸŸ -->
  <view class="image-section {{!imageUrl ? 'empty' : ''}}">
    <block wx:if="{{!imageUrl}}">
      <view class="upload-box" bindtap="chooseImage">
        <text class="upload-emoji">ğŸ–¼ï¸</text>
        <text class="upload-text">ç‚¹å‡»é€‰æ‹©å›¾ç‰‡</text>
        <text class="upload-tip">æ”¯æŒjpgã€pngç­‰æ ¼å¼</text>
      </view>
    </block>
    
    <block wx:else>
      <view class="preview-section">
        <view class="preview-box">
          <image 
            src="{{imageUrl}}" 
            mode="aspectFit" 
            bindtap="previewImage" 
            data-src="{{imageUrl}}"
          />
          <view class="image-info">
            <text>åŸå›¾å¤§å°: {{originalSize/1024}} KB</text>
            <text>å°ºå¯¸: {{imageInfo.width}} x {{imageInfo.height}}</text>
            <text>æ ¼å¼: {{imageInfo.type}}</text>
          </view>
        </view>
        
        <view class="preview-box" wx:if="{{compressedImageUrl}}">
          <image 
            src="{{compressedImageUrl}}" 
            mode="aspectFit" 
            bindtap="previewImage" 
            data-src="{{compressedImageUrl}}"
          />
          <view class="image-info">
            <text>å‹ç¼©å: {{compressedSize/1024}} KB</text>
            <text>å‹ç¼©ç‡: {{compressionRatio}}%</text>
            <text>å°ºå¯¸: {{compressedImageInfo.width}} x {{compressedImageInfo.height}}</text>
          </view>
        </view>
      </view>

      <!-- å‹ç¼©é€‰é¡¹ -->
      <view class="control-section">
        <view class="option-item">
          <view class="section-title">
            <text>å‹ç¼©è´¨é‡</text>
            <text class="value">{{compressOptions.quality}}</text>
          </view>
          <text class="option-tip">æ•°å€¼è¶Šå°å‹ç¼©ç‡è¶Šé«˜ï¼Œå»ºè®®å€¼ï¼š10-30</text>
          <slider 
            min="1" 
            max="100" 
            value="{{compressOptions.quality}}" 
            block-size="24"
            activeColor="#07c160"
            backgroundColor="#eee"
            bindchange="onQualityChange"
          />
        </view>

        <view class="option-item">
          <view class="section-title">
            <text>ç­‰æ¯”ä¾‹ç¼©æ”¾</text>
            <text class="value">{{compressOptions.scale}}%</text>
          </view>
          <text class="option-tip" wx:if="{{imageInfo}}">
            ç¼©æ”¾å: {{imageInfo.width * compressOptions.scale / 100}} x {{imageInfo.height * compressOptions.scale / 100}}
          </text>
          <slider 
            min="10" 
            max="100" 
            value="{{compressOptions.scale}}" 
            block-size="24"
            activeColor="#07c160"
            backgroundColor="#eee"
            bindchange="onScaleChange"
          />
        </view>
      </view>

      <!-- æ“ä½œæŒ‰é’® -->
      <view class="action-section">
        <button 
          class="primary-btn"
          bindtap="compressImage" 
          loading="{{isCompressing}}"
        >
          {{isCompressing ? 'å‹ç¼©ä¸­...' : 'å¼€å§‹å‹ç¼©'}}
        </button>
        
        <button 
          class="secondary-btn"
          bindtap="chooseImage"
        >
          é‡æ–°é€‰æ‹©
        </button>
        
        <button 
          class="secondary-btn"
          bindtap="saveImage" 
          wx:if="{{compressedImageUrl}}"
        >
          ä¿å­˜å›¾ç‰‡
        </button>
      </view>
    </block>
  </view>
</view>